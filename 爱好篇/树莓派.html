<!DOCTYPE html><html lang="zh-CN" color-mode="light"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="前端、免流、技术、运维、手机"><meta name="author" content="记住"><meta name="description" content="我希望有个如你一般的人。 如这山间清晨一般明亮清爽的人， 如奔赴古城道路上阳光一般的人， 温暖而不炙热，覆盖我所有肌肤。 由起点到夜晚，由山野到书房， 一切问题的答案都很简单。 我希望有个如你一般的人，贯彻未来，数遍生命的公路牌。"><title>树莓派从入门到入灰 | 从你的全世界路过</title><link rel="apple-touch-icon" href="/images/avatar.png"><link rel="icon" href="/images/avatar.png"><link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1886449_67xjft27j1l.css"><link rel="stylesheet" href="/css/figcaption/mac-block.css"><script defer type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><link href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" rel="stylesheet"><script defer type="text/javascript" src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="/js/fancybox.js"></script><script>var html=document.documentElement;const colorMode=localStorage.getItem("color-mode");colorMode&&document.documentElement.setAttribute("color-mode",colorMode)</script><meta name="generator" content="Hexo 6.3.0"><style>.github-emoji{position:relative;display:inline-block;width:1.2em;min-height:1.2em;overflow:hidden;vertical-align:top;color:transparent}.github-emoji>span{position:relative;z-index:10}.github-emoji .fancybox,.github-emoji img{margin:0!important;padding:0!important;border:none!important;outline:0!important;text-decoration:none!important;user-select:none!important;cursor:auto!important}.github-emoji img{height:1.2em!important;width:1.2em!important;position:absolute!important;left:50%!important;top:50%!important;transform:translate(-50%,-50%)!important;user-select:none!important;cursor:auto!important}.github-emoji-fallback{color:inherit}.github-emoji-fallback img{opacity:0!important}</style><link rel="alternate" href="/atom.xml" title="从你的全世界路过" type="application/atom+xml"></head><body><div id="app"><div class="header"><div class="avatar"><a href="/"><img src="/images/avatar.png" alt=""></a><div class="nickname"><a href="/">cloud</a></div></div><h1 style="text-align:center;margin-bottom:40px" id="jinrishici-sentence">正在加载今日诗词....</h1><script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script><div class="navbar"><ul><li class="nav-item" data-path="/"><a href="/">Home</a></li><li class="nav-item" data-path="/archives/"><a href="/archives/">Archives</a></li><li class="nav-item" data-path="/tags/"><a href="/tags/">Tags</a></li><li class="nav-item" data-path="/friends/"><a href="/friends/">Friends</a></li><li class="nav-item" data-path="/about/"><a href="/about/">About</a></li></ul></div></div><script src="/js/activeNav.js"></script><div class="flex-container"><script async type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]}}</script><script async type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.10/dist/clipboard.min.js"></script><script src="/js/codeCopy.js"></script><div class="container post-details" id="post-details"><div class="post-content"><div class="post-title">树莓派从入门到入灰</div><div class="post-attach"><span class="post-pubtime"><i class="iconfont icon-updatetime mr-10" title="更新时间"></i> 2022-10-20 10:31:20 </span><span class="post-tags"><i class="iconfont icon-tags mr-10" title="标签"></i> <span class="span--tag mr-8"><a href="/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/" title="树莓派">#树莓派</a></span></span></div><div class="markdown-body"><h1 id="树莓派基础知识"><a href="#树莓派基础知识" class="headerlink" title="树莓派基础知识"></a>树莓派基础知识</h1><h2 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h2><p>ARM处理器是英国Acorn有限公司设计的低功耗成本的第一款<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/RISC/62696">RISC</a>微处理器。全称为Advanced RISC Machine。ARM处理器本身是32位设计，但也配备16位指令集，一般来讲比等价32位代码节省达35%，却能保留32位系统的所有优势。</p><h2 id="核心"><a href="#核心" class="headerlink" title="核心"></a>核心</h2><p>CPU：Broadcom BCM2711，1.5 GHz，64-bit，4核心，ARM Cortex-A72 架构，1MB shared L2 cache<br>RAM：1、2、4 GB LPDDR4-3200 RAM (shared with GPU)</p><h2 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h2><p>以太网：10/100/1000 Mbit/s<br>无线网：b/g/n/ac 双频 2.4/5 GHz<br>蓝牙：5.0</p><h2 id="多媒体"><a href="#多媒体" class="headerlink" title="多媒体"></a>多媒体</h2><p>GPU：Broadcom VideoCore VI @ 500 MHz<br>HDMI：micro-HDMI<br>DSI：板载排线</p><h2 id="外围设备"><a href="#外围设备" class="headerlink" title="外围设备"></a>外围设备</h2><p>17× GPIO plus the same specific functions, HAT, and an additional 4× UART, 4× SPI, and 4× I2C connectors</p><h1 id="树莓派基本配置"><a href="#树莓派基本配置" class="headerlink" title="树莓派基本配置"></a>树莓派基本配置</h1><h2 id="win10连接命令"><a href="#win10连接命令" class="headerlink" title="win10连接命令"></a>win10连接命令</h2><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh root@ip –p21 账号@IP地址 //路由器分配的IP<br>raspberry<br></code></pre></td></tr></tbody></table></figure><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">diskutil list<br>// 格式化磁盘<br>diskutil eraseDisk JHFS+ UntitledUFS /dev/disk2<br></code></pre></td></tr></tbody></table></figure><ul><li>Could not get lock /var/lib/dpkg/lock-frontend. It is held by process 3129 (apt-get)</li></ul><figure class="highlight text"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs text">sudo rm /var/lib/dpkg/lock-frontend<br>sudo rm /var/lib/dpkg/lock<br>sudo rm /var/cache/apt/archives/lock<br></code></pre></td></tr></tbody></table></figure><h1 id="Raspberry系统安装"><a href="#Raspberry系统安装" class="headerlink" title="Raspberry系统安装"></a>Raspberry系统安装</h1><p>系统： Raspberry Pi OS Lite</p><p>安装地址</p><ul><li><a target="_blank" rel="noopener" href="https://www.raspberrypi.com/software/operating-systems/">https://www.raspberrypi.com/software/operating-systems/</a></li></ul><p>系统安装 + 图形界面安装<br>安装系统的方法<br>树莓派的操作系统有两种安装方式：<br>一种：先把树莓派的安装引导程序NOOBS写入SD卡，然后启动树莓派进入NOOBS来安装操作系统。<br>另一种：是使用软件``balenaEtcher`将操作系统镜像写入SD卡，树莓派启动后直接进入操作系统。</p><h3 id="树莓派默认账号密码"><a href="#树莓派默认账号密码" class="headerlink" title="树莓派默认账号密码"></a>树莓派默认账号密码</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">pi<br>raspberry<br></code></pre></td></tr></tbody></table></figure><p>图形界面开启ssh</p><p>sudo raspi-config进入到树莓派系统配置界面。</p><p>Interfacing options</p><h3 id="无显示器连接树莓派"><a href="#无显示器连接树莓派" class="headerlink" title="无显示器连接树莓派"></a>无显示器连接树莓派</h3><p>SSH连接<br>新建boot目录下新建一个SSH文件<br>设置wiff 新建文件<code>wpa_supplicant.conf</code></p><p><b style="color:red">超级重点 树莓派支持2.4GHz的wifi 不支持5Ghz的wifi</b></p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs conf">ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev<br>update_config=1<br>country=CN<br>network={<br>        ssid="ChinaNet-mcEc"<br>        psk="uq7nqawx"<br>        key_mgmt=WPA-PSK 	<br>}<br>network={<br>        ssid="你的其他无线网名字"<br>        psk="密码"<br>        key_mgmt=WPA-PSK<br>}        <br></code></pre></td></tr></tbody></table></figure><p>如果你的 WiFi 没有密码</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">network={``ssid=<span class="hljs-string">"你的无线网络名称（ssid）"</span>``key_mgmt=NONE``}<br></code></pre></td></tr></tbody></table></figure><p>如果你的 WiFi 使用WEP加密</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">network={``ssid=<span class="hljs-string">"你的无线网络名称（ssid）"</span>``key_mgmt=NONE``wep_key0=<span class="hljs-string">"你的wifi密码"</span>``}<br></code></pre></td></tr></tbody></table></figure><p>如果你的 WiFi 使用WPA/WPA2加密</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">network={``ssid=<span class="hljs-string">"你的无线网络名称（ssid）"</span>``key_mgmt=WPA-PSK``psk=<span class="hljs-string">"你的wifi密码"</span>``}<br></code></pre></td></tr></tbody></table></figure><h3 id="VNC远程连接树莓派"><a href="#VNC远程连接树莓派" class="headerlink" title="VNC远程连接树莓派"></a>VNC远程连接树莓派</h3><p>开启VNC 和提高分辨率</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo raspi-config<br>// interface open ssh <br></code></pre></td></tr></tbody></table></figure><h3 id="树莓派固定IP"><a href="#树莓派固定IP" class="headerlink" title="树莓派固定IP"></a>树莓派固定IP</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vi /etc/network/interfaces<br></code></pre></td></tr></tbody></table></figure><p>为了防止树莓派的IP地址每次都变动，可以将DHCP改为静态IP。编辑/etc/dhcpcd.conf文件，加入以下配置即可。如果是有线网，就将wlan0改为eth0。</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">interface wlan0  <br>static ip_address=192.168.1.100/24<br>static routers=192.168.1.1<br>static domain_name_servers=114.114.114.114<br><br>/etc/init.d/networking restart<br></code></pre></td></tr></tbody></table></figure><p>vi vim warning changing a readonly file</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">su <br>root<br></code></pre></td></tr></tbody></table></figure><p>su: Authentication failure</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo passwd root<br></code></pre></td></tr></tbody></table></figure><p>tamporary failure in name resolution</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">vi /etc/resolv.conf<br>nameserver 202.96.209.133<br>nameserver 61.129.88.123<br>nameserver 114.114.114.114<br>nameserver 8.8.8.8<br></code></pre></td></tr></tbody></table></figure><h3 id="更新源"><a href="#更新源" class="headerlink" title="更新源"></a>更新源</h3><ul><li>组成 ：一个Debian源 一个树莓派本源</li></ul><p>Debian</p><ul><li>Debian 7 wheezy</li><li>Debian 8 jessie</li><li>Debian 9 stretch</li><li>Debian 10 buster</li></ul><p><a target="_blank" rel="noopener" href="https://developer.aliyun.com/mirror/debian">https://developer.aliyun.com/mirror/debian</a></p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">lsb_release -a // 查看系统版本<br>No LSB modules are available.<br>Distributor ID:	Raspbian<br>Description:	Raspbian GNU/Linux 11 (bullseye)<br>Release:	11<br>Codename:	bullseye<br></code></pre></td></tr></tbody></table></figure><p>第一种方法 bullseys 换源</p><ul><li>The following signatures couldn’t be verified because the public key is not available</li></ul><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 5523BAEEB01FA116 其中的5523BAEEB01FA116是根据错误提示写的<br></code></pre></td></tr></tbody></table></figure><p><code>/etc/apt/sources.list</code></p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo <span class="hljs-built_in">cp</span> /etc/apt/sources.list /etc/apt/sources.list.bk<br>vi /etc/apt/sources.list<br></code></pre></td></tr></tbody></table></figure><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">deb http://mirrors.ustc.edu.cn/raspbian/raspbian/ bullseye main contrib non-free rpi<br><span class="hljs-comment"># deb-src http://mirrors.ustc.edu.cn/raspbian/raspbian/ bullseye main contrib non-free rpi</span><br></code></pre></td></tr></tbody></table></figure><p><code>/etc/apt/sources.list.d/raspi.list</code></p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo <span class="hljs-built_in">cp</span> /etc/apt/sources.list.d/raspi.list /etc/apt/sources.list.d/raspi.list.bk<br>vi /etc/apt/sources.list.d/raspi.list<br>deb http://mirrors.ustc.edu.cn/archive.raspberrypi.org/debian/ bullseye main ui<br><span class="hljs-comment">#deb-src http://mirrors.ustc.edu.cn/archive.raspberrypi.org/debian/ bullseye main ui</span><br></code></pre></td></tr></tbody></table></figure><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sudo apt update<br>sudo apt upgrade &amp;&amp; sudo apt dist-upgrade<br></code></pre></td></tr></tbody></table></figure><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash">64位镜像可以直接使用debian的系统源，首先需要编辑/etc/apt/sources.list，使用<span class="hljs-comment">#号注释原内容，然后在末尾添加Debian的系统源：</span><br><br><span class="hljs-comment"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span><br>deb https://mirrors.tuna.tsinghua.edu.cn/debian/ buster main contrib non-free<br><span class="hljs-comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ buster main contrib non-free</span><br>deb https://mirrors.tuna.tsinghua.edu.cn/debian/ buster-updates main contrib non-free<br><span class="hljs-comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ buster-updates main contrib non-free</span><br>deb https://mirrors.tuna.tsinghua.edu.cn/debian/ buster-backports main contrib non-free<br><span class="hljs-comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ buster-backports main contrib non-free</span><br>deb https://mirrors.tuna.tsinghua.edu.cn/debian-security buster/updates main contrib non-free<br><span class="hljs-comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/debian-security buster/updates main contrib non-free</span><br>接着需要配置树莓派官方的软件源，编辑<br>/etc/apt/sources.list.d/raspi.list<br>同样的，注释原内容，在末尾添加如下内容：<br><br>deb http://mirrors.tuna.tsinghua.edu.cn/raspberrypi/ buster main ui<br><br>系统源和软件源配置完成以后，使用下述两条命令更新：<br><br>sudo apt update<br>sudo apt upgrade -y<br></code></pre></td></tr></tbody></table></figure><p>第二种方法 buster 换源</p><p>删除内容： 3dd 3 行<br>注意树莓派4B的Respbian是基于Debian 10 Bluster 不要选错。<br>根据提示修改：</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">// d 删除<br>vi /etc/apt/sources.list<br><span class="hljs-comment"># 编辑 `/etc/apt/sources.list` 文件，删除原文件所有内容，用以下内容取代：</span><br>deb http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main non-free contrib<br>deb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main non-free contrib<br>vi /etc/apt/sources.list.d/raspi.list<br><span class="hljs-comment"># 编辑 `/etc/apt/sources.list.d/raspi.list` 文件，删除原文件所有内容，用以下内容取代：</span><br>deb http://mirrors.tuna.tsinghua.edu.cn/raspberrypi/ buster main ui<br><br>apt-get update<br>apt-get upgrade<br></code></pre></td></tr></tbody></table></figure><p>sudo apt-get update后报错<br>The following signatures couldn’t be verified because the public key is not available: NO_PUBKEY XXXXXXXXXXXX<br>直接添加该KEY解决</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt-key adv –keyserver keyserver.ubuntu.com –recv-keys XXXXXXXXX<br></code></pre></td></tr></tbody></table></figure><p>Temporary failure resolving ‘mirrors.ustc.edu.cn’</p><p>Temporary failure in name resolution</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">vim /etc/resolv.conf<br>nameserver 8.8.8.8<br>nameserver 8.8.4.4<br>sudo /etc/init.d/networking restart<br></code></pre></td></tr></tbody></table></figure><h3 id="下载桌面环境"><a href="#下载桌面环境" class="headerlink" title="下载桌面环境"></a>下载桌面环境</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt-get install ubuntu-desktop <br>sudo apt-get update --fix-missing<br></code></pre></td></tr></tbody></table></figure><h1 id="磁力链接下载机"><a href="#磁力链接下载机" class="headerlink" title="磁力链接下载机"></a>磁力链接下载机</h1><ul><li>连接wiff ssh 和<ul><li>pi raspberry</li></ul></li><li>获取 树莓派 ip<ul><li>vpn</li></ul></li><li><h2 id="挂载磁盘工具"><a href="#挂载磁盘工具" class="headerlink" title="挂载磁盘工具"></a>挂载磁盘工具</h2></li><li>qibittorrent<ul><li>ip:8080</li><li>启动 qbittorrent-nox -d</li></ul></li><li>samba<ul><li>启动 smb://ip</li></ul></li><li>ftp</li></ul><h1 id="安装电视机盒子"><a href="#安装电视机盒子" class="headerlink" title="安装电视机盒子"></a>安装电视机盒子</h1><ul><li>直接安装kodi</li><li>先安装树莓派系统再安装kodi</li><li>安装lineOS Android系统</li></ul><h1 id="安装CentOS系统"><a href="#安装CentOS系统" class="headerlink" title="安装CentOS系统"></a>安装CentOS系统</h1><h1 id="安装ubuntu系统"><a href="#安装ubuntu系统" class="headerlink" title="安装ubuntu系统"></a>安装ubuntu系统</h1><p>工具：balenaEtcher<br>镜像：<a target="_blank" rel="noopener" href="https://mirrors.ustc.edu.cn/ubuntu-cdimage/releases/18.04/release/ubuntu-18.04.4-preinstalled-server-armhf%2Braspi4.img.xz.zsync">ubuntu-18.04.4-preinstalled-server-armhf+raspi4..&gt;</a></p><h2 id="格式化SD卡"><a href="#格式化SD卡" class="headerlink" title="格式化SD卡"></a>格式化SD卡</h2><p>使用系统工具格式化SD卡</p><h2 id="使用刻录工具"><a href="#使用刻录工具" class="headerlink" title="使用刻录工具"></a>使用刻录工具</h2><p>使用balenaEtcher 写入 SD卡中</p><h2 id="修改树莓派密码"><a href="#修改树莓派密码" class="headerlink" title="修改树莓派密码"></a>修改树莓派密码</h2><p>默认账号和密码都是：Ubuntu<br>设置的密码要是字母 + 数字 abc123</p><h2 id="更新源-1"><a href="#更新源-1" class="headerlink" title="更新源"></a>更新源</h2><p>备份源</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo <span class="hljs-built_in">cp</span> /etc/apt/sources.list /etc/apt/sources.list.bak<br></code></pre></td></tr></tbody></table></figure><p>编辑 sources.list 文件</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo vi /etc/apt/sources.list<br></code></pre></td></tr></tbody></table></figure><p>打开源的文件，把里面ports.ubuntu.com都换成mirrors.aliyun.com 更新过程要等待</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">esc键 <br>:%s/源字符串/目标字符串/g<br>:%s/ports.ubuntu.com/mirrors.aliyun.com/g<br>:wq!<br></code></pre></td></tr></tbody></table></figure><p>树莓派连接网线，更新源 和 重启 等待更新源</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt-get update<br>sudo apt-get uprade<br>reboot<br></code></pre></td></tr></tbody></table></figure><h2 id="下载桌面环境-1"><a href="#下载桌面环境-1" class="headerlink" title="下载桌面环境"></a>下载桌面环境</h2><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt-get install ubuntu-desktop <br>sudo apt-get update --fix-missing<br></code></pre></td></tr></tbody></table></figure><h1 id="挂载磁盘"><a href="#挂载磁盘" class="headerlink" title="挂载磁盘"></a>挂载磁盘</h1><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ef23a1b88c22">树莓派之挂载移动硬盘 - 简书</a><br>查看磁盘状态</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo fdisk -l<br><span class="hljs-built_in">df</span> -h<br>先建一个目录 ，让树莓派挂载在创建的目录<br>先建一个目录 ，让树莓派挂载在创建的目录<br>sudo <span class="hljs-built_in">mkdir</span> /home/pi/toshiba<br>先建一个目录 ，让树莓派挂载在创建的目录<br>sudo mount /dev/sda1  /home/pi/toshiba<br></code></pre></td></tr></tbody></table></figure><p>6.安装NTFS格式可读写软件</p><blockquote><p><em>sudo aptitude install ntfs-3g</em><br>7.加载内核模块<br><em>modprobe fuse</em><br>8.让移动硬盘开机自动挂载<br><em>sudo nano /etc/fstab</em><br>最后一行添加<br>/dev/sda1 /home/pi/toshiba ntfs-3g defaults,noexec,umask=0000 0 0<br>9.有时候，挂载会出错，Mount is denied：<br><strong>挂载exFAT格式的硬盘</strong><br>FAT 格式U盘 mount 本身就能支持，但如果你的U盘或移动硬盘使用的是 exFAT 格式，mount 会说不支持。没关系，安装 exfat-fuse 软件之后 mount 就支持了。<br>sudo apt-get install exfat-fuse<br>如果想开机自动挂载，而不是每次手工执行，可以编辑 /etc/fstab 文件。比如在末尾添加一行：<br>/dev/sda1 /mnt/usbdisk vfat rw,defaults 0 0</p></blockquote><h1 id="安装aira2下载机"><a href="#安装aira2下载机" class="headerlink" title="安装aira2下载机"></a>安装aira2下载机</h1><blockquote><p><a target="_blank" rel="noopener" href="https://www.freesion.com/article/4555471768/">树莓派下载机aria2+Samba搭建NAS下载机 - 灰信网（软件开发博客聚合）</a><br><a target="_blank" rel="noopener" href="https://hacpai.com/article/1548140422018">搭建 aria2 下载机一键脚本 - 黑客派</a></p></blockquote><h1 id="安装百度网盘下载机"><a href="#安装百度网盘下载机" class="headerlink" title="安装百度网盘下载机"></a>安装百度网盘下载机</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>安装 BaiduPCS-Go web<br><a target="_blank" rel="noopener" href="https://github.com/mayunbaba2/BaiduPCS-Go-Web">Github</a><br>下载 BaiduPCS-Go web<br>链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1EGhXzzpeSd5UsAMAPjaIVw">https://pan.baidu.com/s/1EGhXzzpeSd5UsAMAPjaIVw</a> 提取码：c4v2<br>解压安装包</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">unzip BaiduPCS-Go-3.7.0-linux-arm.zip<br></code></pre></td></tr></tbody></table></figure><p>进入 解压后的文件夹，执行以下命令即可在树莓派上安装 BaiduPCS-Go 。</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> BaiduPCS-Go-3.7.0-linux-arm     <span class="hljs-comment">#cd 到软件所在的目录</span><br><span class="hljs-built_in">chmod</span> a+x BaiduPCS-Go <br>./BaiduPCS-Go<br></code></pre></td></tr></tbody></table></figure><p>打开http://树莓派的ip地址:5299就可以看到百度云的登陆界面啦。</p><h2 id="登陆"><a href="#登陆" class="headerlink" title="登陆"></a>登陆</h2><ul><li>百度云账号登陆</li><li>BDUSS登陆<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/mayuko2012/article/details/48196729">bduss获取</a></li></ul><h2 id="设置"><a href="#设置" class="headerlink" title="设置"></a>设置</h2><p>设置下载目录</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/media/pi/Backup Plus/<br></code></pre></td></tr></tbody></table></figure><h1 id="安装emby-server服务器"><a href="#安装emby-server服务器" class="headerlink" title="安装emby server服务器"></a>安装emby server服务器</h1><p>媒体服务器</p><ul><li>flex</li><li>emby</li><li>jellyfin<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">dpkg -i emby-server-deb_4.2.0.5_armhf.deb<br></code></pre></td></tr></tbody></table></figure><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">// 等待时间较长<br>Selecting previously unselected package emby-server.<br>(Reading database ... 158438 files and directories currently installed.)<br>Preparing to unpack emby-server-deb_4.4.3.0_armhf.deb ...<br>Unpacking emby-server (4.4.3.0) ...<br>Setting up emby-server (4.4.3.0) ...<br>usermod: no changes<br>Created symlink /etc/systemd/system/multi-user.target.wants/emby-server.service → /usr/lib/systemd/system/emby-server.service.<br>Processing triggers <span class="hljs-keyword">for</span> libc-bin (2.28-10+rpi1) ...<br></code></pre></td></tr></tbody></table></figure>访问树莓派IP地址:8096</li></ul><h1 id="安装next-cloud云盘"><a href="#安装next-cloud云盘" class="headerlink" title="安装next cloud云盘"></a>安装next cloud云盘</h1><p><strong>nextcloud</strong>前身是大名鼎鼎的<strong>owncloud</strong>，两者均是开源的网络硬盘系统。<strong>nextcloud</strong>不仅可以搭建私有云存储和同步数据，也提供联系人、日程管理功能，web端还提供私密的语音视频通话功能。<strong>nextcloud</strong>致力于数据安全，云端的数据均可选择加密，并遵循安全行业最佳实践。客户端支持windows、macos、linux三大pc平台，以及安卓ios两大移动平台，完全足够家庭或中小型团队协作使用。</p><h2 id="部署和设置nextcloud"><a href="#部署和设置nextcloud" class="headerlink" title="部署和设置nextcloud"></a>部署和设置nextcloud</h2><p>nextcloud程序由php语言编写，因此部署需要具备php运行环境以及web中间件。因其支持平台众多，官方文档略显繁琐，故本文给出<strong>树莓派</strong>上用nginx、mariadb、redis搭建nextcloud的详细步骤。<br>从官网<a target="_blank" rel="noopener" href="https://nextcloud.com/install/#instructions-server">下载部署程序</a>；<br>用迅雷进行下载再上传, 或者在树莓派运行命令进行下载(外网, 很慢):</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://download.nextcloud.com/server/releases/nextcloud-19.0.1.zip<br></code></pre></td></tr></tbody></table></figure><p>更新系统和必备软件：<br><code>sudo apt update &amp;&amp; sudo apt upgrade &amp;&amp; sudo apt install -y libreoffice ffmpeg</code>；<br>安装nginx：<code>sudo apt install -y nginx</code>；<br>安装redis：<code>sudo apt install -y redis</code>;<br>安装mariadb：<code>sudo apt install mariadb-server</code>；<br>安装php及推荐模块：<code>sudo apt install -y php7.3 php7.3-fpm php7.3-curl php7.3-gd php7.3-dom php7.3-iconv php7.3-openssl php-redis php-mysql php7.3-zip php7.3-bz2 php7.3-intl php7.3-imagick</code>；<br>解压部署程序：<code>unzip nextcloud-xxxx.zip</code>；<br>将nextcloud文件移动到网站根目录：<code>sudo mv nextcloud-xxx /var/www/html/nextcloud</code>；<br>创建数据目录，更改目录权限：<code>mkdir /var/www/html/nextcloud/data &amp;&amp; sudo chown -R www-data:www-data /var/www/html/nextcloud</code>；<br>配置php：打开<br>/etc/php/7.3/fpm/php.ini<br>文件，做如下更改：<br>expose_php改成off<br>date.timezone 一行删掉前面的;号，值改成Asia/Shanghai<br>删掉opcache.enable=1，opcache.validate_timestamps=1，opcache.revalidate_freq=2这三行前面的;号，将opcache.revalidate_freq的值改成30;<br>配置fpm：打开**/etc/php/7.3/fpm/pool.d/<a href="http://www.conf**文件，移除clear_env=no，env[开头那几行前面的;号（即388，401-405这几行前面的分号）；">www.conf**文件，移除clear_env=no，env[开头那几行前面的;号（即388，401-405这几行前面的分号）；</a><br>设置mariadb管理员密码： <code>mysqladmin -uroot password '你的密码'</code>;<br>创建nextcloud数据库：<code>mysql -uroot -p'你的密码' -e 'create user nextcloud@"%" identified by "nextcloud数据库密码"; create database nextcloud default charset=utf8mb4; grant all privileges on nextcloud.* to nextcloud@"%"; flush privileges;'</code>；<br>配置nginx：在<br>/etc/nginx/sites-enabled<br>目录下，创建一个nextcloud文件，其内容如下（注意，本配置中禁用了https）：</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs bash">upstream php-handler {<br>server unix:/run/php/php7.3-fpm.sock;<br>}<br>server {<br>listen 80;<br>listen [::]:80;<br>server_name cloud.example.com;<br><span class="hljs-comment"># enforce https</span><br><span class="hljs-comment">#return 301 https://$server_name:443$request_uri;</span><br><span class="hljs-comment">#}</span><br><span class="hljs-comment">#server {</span><br><span class="hljs-comment">#    listen 443 ssl http2;</span><br><span class="hljs-comment">#    listen [::]:443 ssl http2;</span><br><span class="hljs-comment">#    server_name cloud.example.com;</span><br><span class="hljs-comment"># Use Mozilla's guidelines for SSL/TLS settings</span><br><span class="hljs-comment"># https://mozilla.github.io/server-side-tls/ssl-config-generator/</span><br><span class="hljs-comment"># <span class="hljs-doctag">NOTE:</span> some settings below might be redundant</span><br><span class="hljs-comment">#    ssl_certificate /etc/ssl/nginx/cloud.example.com.crt;</span><br><span class="hljs-comment">#    ssl_certificate_key /etc/ssl/nginx/cloud.example.com.key;</span><br><span class="hljs-comment"># Path to the root of your installation</span><br>root /var/www/html/nextcloud;<br>location = /robots.txt {<br>    allow all;<br>    log_not_found off;<br>    access_log off;<br>}<br><span class="hljs-comment"># The following 2 rules are only needed for the user_webfinger app.</span><br><span class="hljs-comment"># Uncomment it if you're planning to use this app.</span><br><span class="hljs-comment">#rewrite ^/.well-known/host-meta /public.php?service=host-meta last;</span><br><span class="hljs-comment">#rewrite ^/.well-known/host-meta.json /public.php?service=host-meta-json last;</span><br><span class="hljs-comment"># The following rule is only needed for the Social app.</span><br><span class="hljs-comment"># Uncomment it if you're planning to use this app.</span><br><span class="hljs-comment">#rewrite ^/.well-known/webfinger /public.php?service=webfinger last;</span><br>location = /.well-known/carddav {<br>  <span class="hljs-built_in">return</span> 301 <span class="hljs-variable">$scheme</span>://<span class="hljs-variable">$host</span>:<span class="hljs-variable">$server_port</span>/remote.php/dav;<br>}<br>location = /.well-known/caldav {<br>  <span class="hljs-built_in">return</span> 301 <span class="hljs-variable">$scheme</span>://<span class="hljs-variable">$host</span>:<span class="hljs-variable">$server_port</span>/remote.php/dav;<br>}<br><span class="hljs-comment"># set max upload size</span><br>client_max_body_size 512M;<br>fastcgi_buffers 64 4K;<br><span class="hljs-comment"># Enable gzip but do not remove ETag headers</span><br>gzip on;<br>gzip_vary on;<br>gzip_comp_level 4;<br>gzip_min_length 256;<br>gzip_proxied expired no-cache no-store private no_last_modified no_etag auth;<br>gzip_types application/atom+xml application/javascript application/json application/ld+json application/manifest+json application/rss+xml application/vnd.geo+json application/vnd.ms-fontobject application/x-font-ttf application/x-web-app-manifest+json application/xhtml+xml application/xml font/opentype image/bmp image/svg+xml image/x-icon text/cache-manifest text/css text/plain text/vcard text/vnd.rim.location.xloc text/vtt text/x-component text/x-cross-domain-policy;<br><span class="hljs-comment"># Uncomment if your server is build with the ngx_pagespeed module</span><br><span class="hljs-comment"># This module is currently not supported.</span><br><span class="hljs-comment">#pagespeed off;</span><br>location / {<br>    rewrite ^ /index.php;<br>}<br>location ~ ^\/(?:build|tests|config|lib|3rdparty|templates|data)\/ {<br>    deny all;<br>}<br>location ~ ^\/(?:\.|autotest|occ|issue|indie|db_|console) {<br>    deny all;<br>}<br>location ~ ^\/(?:index|remote|public|cron|core\/ajax\/update|status|ocs\/v[12]|updater\/.+|oc[ms]-provider\/.+)\.php(?:$|\/) {<br>    fastcgi_split_path_info ^(.+?\.php)(\/.*|)$;<br>    <span class="hljs-built_in">set</span> <span class="hljs-variable">$path_info</span> <span class="hljs-variable">$fastcgi_path_info</span>;<br>    try_files <span class="hljs-variable">$fastcgi_script_name</span> =404;<br>    include fastcgi_params;<br>    fastcgi_param SCRIPT_FILENAME $document_root<span class="hljs-variable">$fastcgi_script_name</span>;<br>    fastcgi_param PATH_INFO <span class="hljs-variable">$path_info</span>;<br>    <span class="hljs-comment">#fastcgi_param HTTPS on;</span><br>    <span class="hljs-comment"># Avoid sending the security headers twice</span><br>    fastcgi_param modHeadersAvailable <span class="hljs-literal">true</span>;<br>    <span class="hljs-comment"># Enable pretty urls</span><br>    fastcgi_param front_controller_active <span class="hljs-literal">true</span>;<br>    fastcgi_pass php-handler;<br>    fastcgi_intercept_errors on;<br>    fastcgi_request_buffering off;<br>}<br>location ~ ^\/(?:updater|oc[ms]-provider)(?:$|\/) {<br>    try_files <span class="hljs-variable">$uri</span>/ =404;<br>    index index.php;<br>}<br><span class="hljs-comment"># Adding the cache control header for js, css and map files</span><br><span class="hljs-comment"># Make sure it is BELOW the PHP block</span><br>location ~ \.(?:css|js|woff2?|svg|gif|map)$ {<br>    try_files <span class="hljs-variable">$uri</span> /index.php<span class="hljs-variable">$request_uri</span>;<br>    add_header Cache-Control <span class="hljs-string">"public, max-age=15778463"</span>;<br>    <span class="hljs-comment"># Add headers to serve security related headers (It is intended to</span><br>    <span class="hljs-comment"># have those duplicated to the ones above)</span><br>    <span class="hljs-comment"># Before enabling Strict-Transport-Security headers please read into</span><br>    <span class="hljs-comment"># this topic first.</span><br>    <span class="hljs-comment">#add_header Strict-Transport-Security "max-age=15768000; includeSubDomains; preload;" always;</span><br>    <span class="hljs-comment">#</span><br>    <span class="hljs-comment"># WARNING: Only add the preload option once you read about</span><br>    <span class="hljs-comment"># the consequences in https://hstspreload.org/. This option</span><br>    <span class="hljs-comment"># will add the domain to a hardcoded list that is shipped</span><br>    <span class="hljs-comment"># in all major browsers and getting removed from this list</span><br>    <span class="hljs-comment"># could take several months.</span><br>    add_header Referrer-Policy <span class="hljs-string">"no-referrer"</span> always;<br>    add_header X-Content-Type-Options <span class="hljs-string">"nosniff"</span> always;<br>    add_header X-Download-Options <span class="hljs-string">"noopen"</span> always;<br>    add_header X-Frame-Options <span class="hljs-string">"SAMEORIGIN"</span> always;<br>    add_header X-Permitted-Cross-Domain-Policies <span class="hljs-string">"none"</span> always;<br>    add_header X-Robots-Tag <span class="hljs-string">"none"</span> always;<br>    add_header X-XSS-Protection <span class="hljs-string">"1; mode=block"</span> always;<br>    <span class="hljs-comment"># Optional: Don't log access to assets</span><br>    access_log off;<br>}<br>location ~ \.(?:png|html|ttf|ico|jpg|jpeg|bcmap)$ {<br>    try_files <span class="hljs-variable">$uri</span> /index.php<span class="hljs-variable">$request_uri</span>;<br>    <span class="hljs-comment"># Optional: Don't log access to other assets</span><br>    access_log off;<br>}<br>}<br></code></pre></td></tr></tbody></table></figure><p>启动各项服务：<code>sudo systemctl restart nginx php7.3-fpm redis-server mariadb</code>。如果系统安装了防火墙，记得放行80端口；<br>打开浏览器，在地址栏输入树莓派的ip，例如：<a target="_blank" rel="noopener" href="http://192.168.1.2,将出现nextcloud的设置页面,选择用户名和密码,以及输入数据库用户名和密码,完成设置./">http://192.168.1.2，将出现nextcloud的设置页面，选择用户名和密码，以及输入数据库用户名和密码，完成设置。</a><br>设置完成后，进入了类似百度云盘的操作界面，说明云盘已经初步搭建好了。<br>配置nextcloud，使其性能更好：打开**/var/www/html/nextcloud/config/config.php**文件，在最后的);前添加缓存配置： <code>'memcache.local' =&gt; '\OC\Memcache\Redis','memcache.distributed' =&gt; '\OC\Memcache\Redis','redis' =&gt; ['host' =&gt; 'localhost','port' =&gt; 6379,'dbindex' =&gt; 0,'password' =&gt; '','timeout' =&gt; 1.5,],</code><br>至此，nextcloud的部署和设置全部完毕，在浏览器界面已经能够查看和管理各种数据和功能了。</p><h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><ol><li>树莓派默认的sd卡存储空间很小，实践应该将nextcloud的程序文件托管在外置硬盘上；</li><li>设置外网访问需要用到域名、dns、https配置以及内网穿透，本文不再给出；</li><li>各平台客户端的设置和使用请参考官方教程，本文不再给出<br>启动树莓派，你需要一个显示器，并且连接上键盘，登陆系统用户名pi，密码raspberry。安装openssh-server， 并且使用service ssh start启动ssh-server服务。这可以确保你可以使用ssh远程连接到树莓派。</li></ol><h1 id="安装kodi"><a href="#安装kodi" class="headerlink" title="安装kodi"></a>安装kodi</h1><ul><li>安装 <a target="_blank" rel="noopener" href="https://github.com/kodi-pvr">pvr client</a></li><li>配置 kodi 自动启动</li><li>启动 kodi</li></ul><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ service kodi start<br></code></pre></td></tr></tbody></table></figure><h1 id="安装hexo博客"><a href="#安装hexo博客" class="headerlink" title="安装hexo博客"></a>安装hexo博客</h1><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/127757097">https://zhuanlan.zhihu.com/p/127757097</a></p><p>无效的问题</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">vi /etc/profile<br><span class="hljs-built_in">export</span> PATH=<span class="hljs-string">"<span class="hljs-variable">$PATH</span>:/usr/local/node-v8.11.3-linux-x64/bin"</span><br><span class="hljs-built_in">source</span> /etc/profile<br></code></pre></td></tr></tbody></table></figure><p><a target="_blank" rel="noopener" href="https://github.com/521xueweihan/GitHub520">https://github.com/521xueweihan/GitHub520</a></p><ul><li>解决raw.githubusercontent.com地址DNS污染</li></ul><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">151.101.0.133 raw.githubusercontent.com<br></code></pre></td></tr></tbody></table></figure><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo vi /etc/hosts<br>151.101.0.133 raw.githubusercontent.com<br></code></pre></td></tr></tbody></table></figure><p>pm2</p><p><a target="_blank" rel="noopener" href="https://linkscue.com/posts/2018-05-06-how-to-use-pm2-manage-hexo-blog/">https://linkscue.com/posts/2018-05-06-how-to-use-pm2-manage-hexo-blog/</a></p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pm2 start --name blog hexo -- s<br></code></pre></td></tr></tbody></table></figure><p>hexo</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install hexo-cli -g<br>hexo init blog<br><span class="hljs-built_in">cd</span> blog <br>npm i<br>npm run dev<br></code></pre></td></tr></tbody></table></figure><h2 id="安装wordpress博客"><a href="#安装wordpress博客" class="headerlink" title="安装wordpress博客"></a>安装wordpress博客</h2><h1 id="安装qbittorrent"><a href="#安装qbittorrent" class="headerlink" title="安装qbittorrent"></a>安装qbittorrent</h1><h3 id="安装qBittorrent"><a href="#安装qBittorrent" class="headerlink" title="安装qBittorrent"></a>安装qBittorrent</h3><figure class="highlight text"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">sudo apt install -y qbittorrent-nox<br></code></pre></td></tr></tbody></table></figure><p>如果提示未找到软件的话可以先update一下：</p><figure class="highlight text"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">sudo apt update<br></code></pre></td></tr></tbody></table></figure><h3 id="启动qbittorrent"><a href="#启动qbittorrent" class="headerlink" title="启动qbittorrent"></a>启动qbittorrent</h3><figure class="highlight text"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">qbittorrent-nox -d <br></code></pre></td></tr></tbody></table></figure><p>这时候，我们就可以打开浏览器，输入你树莓派的ip地址，qbittorrent默认webui的端口号为8080，比如：</p><figure class="highlight text"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">你的树莓派ip:8080<br></code></pre></td></tr></tbody></table></figure><p>默认账号<code>admin</code> 和密码 <code>adminadmin</code></p><h3 id="服务开机自启"><a href="#服务开机自启" class="headerlink" title="服务开机自启"></a>服务开机自启</h3><p>以上就是这个教程最核心的部分了。还有一个问题就是如何让这个服务开机自启，一般来说有两个办法。</p><h4 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h4><p>一个是利用rc.lcal脚本，再exit 0前面加入：</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vim /etc/rc.local<br></code></pre></td></tr></tbody></table></figure><figure class="highlight text"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">qbittorrent-nox -d<br></code></pre></td></tr></tbody></table></figure><h4 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h4><p>另一个方法是将qbittorrent加入到系统服务中。首先，用vim创建一个文件</p><figure class="highlight text"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">vim /etc/systemd/system/qbittorrent.service<br></code></pre></td></tr></tbody></table></figure><p>在文件中写入以下内容：</p><figure class="highlight vim"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs vim">[Unit]<br>Description=qBittorrent Daemon Service<br>After=network.target<br>[Service]<br>User=pi<br>ExecStart=/usr/bin/qbittorrent-nox<br>ExecStop=/usr/bin/killall -<span class="hljs-keyword">w</span> qbittorrent-nox<br>[Install]<br>WantedBy=multi-user.target<br></code></pre></td></tr></tbody></table></figure><p>然后，用systemctl命令重新载入daemon：</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs octave">systemctl daemon-reload<br></code></pre></td></tr></tbody></table></figure><p>到这里，你就可以使用systemctl命令来查看、启动、停止qbittorrent服务了。如果要让它开机自启，只需要输入以下命令：</p><figure class="highlight text"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">systemctl enable qbittorrent-nox.service<br></code></pre></td></tr></tbody></table></figure><h1 id="安装openwrt"><a href="#安装openwrt" class="headerlink" title="安装openwrt"></a>安装openwrt</h1><p>openwrt 安装</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">opkg update <br>opkg install <br>opkg install lsblk cfdisk luci luci-base luci-compat block-mount<br>opkg install luci luci-base luci-compat<br>opkg install block-mount <br><br>opkg install docker-ce<br>/tmp下文件 添加 GUI<br>luci-lib-docker_v0.3.2_all.ipk<br>luci-app-dockermon_v0.5.7_all.ipk <br>luci-i18n-base-zh 中文<br></code></pre></td></tr></tbody></table></figure><p>第三方魔改集成openwrt</p><p><a target="_blank" rel="noopener" href="https://github.com/SuLingGG/OpenWrt-Rpi/releases/tag/x86-64">Release openwrt-x86-64 · SuLingGG/OpenWrt-Rpi</a></p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh连接树莓派ssh root@192.168.1.1，密码为password<br></code></pre></td></tr></tbody></table></figure><p>格式化</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mkfs.ext4 /dev/sda3 <br></code></pre></td></tr></tbody></table></figure><p>挂载点</p><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/read/cv9714518">树莓派4B 亲手打造一款Openwrt软路由(带编译固件-超详细) - RaspberryPi硬核系列(三) - 哔哩哔哩</a></p><p>挂载overlay</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">// disk <br>fdisk -l <br>cfdisk /dev/mmcblk<br>opkg install cfdisk<br>mkfs.ext4 /dev/sda3<br>mount /dev/sda3 /mnt/sda3<br><span class="hljs-built_in">cd</span> /overlay <br><span class="hljs-built_in">ls</span> <br><span class="hljs-built_in">cp</span> -r /overlay/* /mnt/sda3<br><span class="hljs-built_in">ls</span> /mnt/sda3<br>系统挂载目录<br></code></pre></td></tr></tbody></table></figure><p>docke 安装emby-server</p><figure class="highlight docker"><figcaption><span>run -d \</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs docker">// 拉取镜像<br>docker pull emby/embyserver:latest<br>// 容器运行环境<br>// 新建容器 条件按钮 开始配置新的容器参数<br>emby<br>绑定挂载<br>配置文件目录<br>媒体文件目录<br>设备<br>// 启动容器<br></code></pre></td></tr></tbody></table></figure><p>error</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">/opt/docker/tmp/GetImageBlob924900034 no such file or directory <br><br>no space left on device<br><br>docker -d 启动 查看异常现象<br><span class="hljs-built_in">cd</span> /var/lib/docker<br><span class="hljs-built_in">mkdir</span> tmp<br></code></pre></td></tr></tbody></table></figure><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker run -d \<br>    --name=emby \<br>    --volume /mnt/mmcblk0p3/docker/emby_lib:/config \                   <br>    --volume /mnt/mmcblk0p3/server:/movies \                                    <br>    --device /dev/dri/renderD128 \<br>    --publish 8096:8096 \<br>    --publish 8920:8920 \<br>    --<span class="hljs-built_in">env</span> UID=1000 \<br>    --<span class="hljs-built_in">env</span> GID=100 \<br>    --<span class="hljs-built_in">env</span> GIDLIST=100 \<br>    emby/embyserver:latest<br></code></pre></td></tr></tbody></table></figure><h1 id="安装dns"><a href="#安装dns" class="headerlink" title="安装dns"></a>安装dns</h1><p>树莓派上安装Pi-hole搭建DNS服务器，过滤网页广告 | 科技爱好者博客 -专注于树莓派（Raspberry Pi）<br><a target="_blank" rel="noopener" href="https://www.lxx1.com/2422">https://www.lxx1.com/2422</a></p><h1 id="安装Adguard-Home"><a href="#安装Adguard-Home" class="headerlink" title="安装Adguard Home"></a>安装Adguard Home</h1><h1 id="安装ftp"><a href="#安装ftp" class="headerlink" title="安装ftp"></a>安装ftp</h1><p>使用SFTP远程传输树莓派文件 | 树莓派实验室<br><a target="_blank" rel="noopener" href="https://shumeipai.nxez.com/2013/09/07/use-the-remote-sftp-file-transfer-raspberry-pi.html">https://shumeipai.nxez.com/2013/09/07/use-the-remote-sftp-file-transfer-raspberry-pi.html</a><br>只需在“快速连接”中输入：<br>主机：s<a href="ftp://192.168.1.102/">ftp://192.168.1.102</a> （换成您的树莓派的IP地址。前面的sftp://一定要加）<br>用户名和密码照实填。（Raspbian默认是pi/raspberry）</p><p>vsftpd是开源的轻量级的常用ftp服务器．</p><p>1,安装vsftpd服务器 (约400KB)</p><p>sudo apt-get install vsftpd</p><p>2,启动ftp服务</p><p>sudo service vsftpd start</p><p>3,编辑vsftdp的配置文件</p><p>sudo nano /etc/vsftpd.conf</p><p>找到以下行，定义一下</p><p>anonymous_enable=NO</p><p>表示：不允许匿名访问</p><p>local_enable=YES</p><p>设定本地用户可以访问。</p><p>write_enable=YES</p><p>设定可以进行写操作</p><p>local_umask=022</p><p>设定上传后文件的权限掩码。</p><p>存盘退出</p><p>4, 重启vsftpd服务</p><p>sudo service vsftpd restart</p><p>5, 测试一下, OK</p><p>通过ftp连接树莓派系统，以用户名pi登录，密码是raspberry ，即当前系统的用户名密码</p><p>ftp的根目录是/home/pi，即pi用户的HOME目录</p><p>可上传或下载文件了</p><p>如果设置为其他目录 需要在配置文件中添加以下</p><p>local_root=/home/pi/ftp</p><p>allow_writeable_chroot=YES</p><p>这种情况下可能会出现没有文件夹权限 需要给文件夹设置权限</p><p>在linux下执行 sudo chmod -R 777 /home/pi/ftp</p><h2 id="安装docker"><a href="#安装docker" class="headerlink" title="安装docker"></a>安装docker</h2><h1 id="安装Samba"><a href="#安装Samba" class="headerlink" title="安装Samba"></a>安装Samba</h1><p>\\192.168.1.11</p><blockquote><p>树莓派在家中至少三个作用：<code>家庭资源共享中心</code>、<code>无线打印服务器</code>、<code>下载服务器</code>。<br><code>家庭资源共享中心</code>用<code>samba</code>实现家庭局域网共享，树莓派4B的话可以接2个3.0的移动硬盘。<br>实测速度不快，Win读<code>2Mb/s</code>写<code>1Mb/s</code>，Mac读<code>1Mb/s</code>写<code>0.5Mb/s</code>，传小文件比较方便，备份资料可以的，视频不是超高清也能放，但是大文件建议还是直接接电脑。</p></blockquote><h2 id="安装准备"><a href="#安装准备" class="headerlink" title="安装准备"></a>安装准备</h2><p>记得安装前先更新一下源，不然可能有些包安装不全。</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt-get update<br></code></pre></td></tr></tbody></table></figure><h2 id="安装及配置"><a href="#安装及配置" class="headerlink" title="安装及配置"></a>安装及配置</h2><ul><li>mount: /mnt: special device /dev/sda does not exist.</li><li>mount: /mnt: wrong fs type, bad option, bad superblock on /dev/sda, missing codepage or helper program, or other error.</li></ul><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">ps aux | grep fsck<br>sudo pkill -f fsck<br><br><br>diskutil eraseDisk JHFS+ UntitledUFS /dev/disk2<br></code></pre></td></tr></tbody></table></figure><p>修复磁盘命令</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">fsck.ext4 m命令<br>fsck -t ext4 -v /dev/sda1<br>fsck -r /dev/sdb1<br></code></pre></td></tr></tbody></table></figure><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs bash">fdisk -l<br>mount /dev/sda /mnt<br><span class="hljs-built_in">df</span> -h<br>umount /mnt/data<br><br>vi /etc/fstab // 自动挂载<br>添加 <br>/dev/sda /mnt ext4 default  1 1 <br><br><span class="hljs-built_in">cd</span> /mnt<br><br>硬盘测速<br>apt install hdparm<br>hdparm -Tt /dev/sda<br><br><br><span class="hljs-built_in">mkdir</span> data<br><span class="hljs-built_in">chown</span> -R root:<span class="hljs-built_in">users</span> /mnt/data<br><span class="hljs-built_in">chmod</span> -R ug=rwx,o=rx /mnt/data<br><br><br>vi /etc/samba/smb.conf<br>// pi 密码 123<br><br>// 查找<br>/Auth<br><br>security = user<br>ready only  = no<br><br>[public]<br> 	comment = public storage <br> 	path = /mnt/<br> 	valid <span class="hljs-built_in">users</span> = @<span class="hljs-built_in">users</span><br> 	force group = <span class="hljs-built_in">users</span><br> 	creat maske = 0660<br>	directory mask = 0771<br>	ready-only = no<br>	<br>	<br>smbpasswd -a pi	<br><br>apt-get install samba samba-common-bin<br><span class="hljs-comment"># 安装</span><br>sudo nano /etc/samba/smb.conf<br><span class="hljs-comment">#修改配置文件fdis</span><br><span class="hljs-comment"># 在smb.conf文件末尾加入下边两段</span><br>/media/pi/Backup Plus/else/<br>[myshare]                       <span class="hljs-comment"># 显示名称</span><br>comment = my share directory    <span class="hljs-comment"># 共享说明</span><br>path = /home/pi                 <span class="hljs-comment"># 共享目录，可自行修改</span><br>browseable = <span class="hljs-built_in">yes</span>                <span class="hljs-comment"># 可读权限</span><br>writeable = <span class="hljs-built_in">yes</span>                 <span class="hljs-comment"># 写入权限</span><br>guest ok = <span class="hljs-built_in">yes</span>                  <span class="hljs-comment"># 可写可不写</span><br>[portable]                      <span class="hljs-comment"># 移动硬盘</span><br>comment = portable disk        <br>path = /media/pi                <span class="hljs-comment"># 移动硬盘目录，接几个都会显示在这里</span><br>browseable = <span class="hljs-built_in">yes</span>                <br>writeable = <span class="hljs-built_in">yes</span>                 <br>guest ok = <span class="hljs-built_in">yes</span><br><span class="hljs-comment"># 保存（ctrl+o）退出（ctrl+x）</span><br>sudo smbpasswd -a pi<br><span class="hljs-comment"># 默认用户pi，设置密码</span><br>sudo smbpasswd -e pi<br><span class="hljs-comment"># 激活用户</span><br>sudo service smbd restart<br><span class="hljs-comment"># 重启服务</span><br>sudo /etc/init.d/samba start<br><span class="hljs-comment"># 如果没有开启，可以手动开启，如果还连不上就重启树莓派吧</span><br>sudo nano /etc/rc.local<br><span class="hljs-comment"># 如需自动启动，可将上一行命令（sudo /etc/init.d/samba start—）加到exit 0 之前</span><br></code></pre></td></tr></tbody></table></figure><p>设置/media/pi 文件夹权限<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/kaerxifa/p/10931523.html">linux文件夹　权限为所有用户可 读写</a><br>使用命令：</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo <span class="hljs-built_in">chmod</span> 777 <span class="hljs-built_in">dirname</span> -R<br></code></pre></td></tr></tbody></table></figure><h1 id="安装owv"><a href="#安装owv" class="headerlink" title="安装owv"></a>安装owv</h1><ul><li><strong>OpenMediaVault</strong></li></ul><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget -O - https://github.com/OpenMediaVault-Plugin-Developers/installScript/raw/master/install | sudo bash<br></code></pre></td></tr></tbody></table></figure><p>http://&lt;树莓派的IP地址&gt;<br>即可看到 OMV 的登录页，默认的用户名为「admin」，密码「openmediavault」。</p><h1 id="安装阿里网盘"><a href="#安装阿里网盘" class="headerlink" title="安装阿里网盘"></a>安装阿里网盘</h1><h1 id="安装emby"><a href="#安装emby" class="headerlink" title="安装emby"></a>安装emby</h1><h1 id="安装Nginx"><a href="#安装Nginx" class="headerlink" title="安装Nginx"></a>安装Nginx</h1><h1 id="自动化部署博客"><a href="#自动化部署博客" class="headerlink" title="自动化部署博客"></a>自动化部署博客</h1><h1 id="CNS搭建"><a href="#CNS搭建" class="headerlink" title="CNS搭建"></a>CNS搭建</h1><h1 id="搭建免流TinyProxy"><a href="#搭建免流TinyProxy" class="headerlink" title="搭建免流TinyProxy"></a>搭建免流TinyProxy</h1><h1 id="搭建免流面板服务"><a href="#搭建免流面板服务" class="headerlink" title="搭建免流面板服务"></a>搭建免流面板服务</h1><h1 id="DHCP搭建"><a href="#DHCP搭建" class="headerlink" title="DHCP搭建"></a>DHCP搭建</h1><h1 id="自动脚本搭建"><a href="#自动脚本搭建" class="headerlink" title="自动脚本搭建"></a>自动脚本搭建</h1><ul><li>青龙面板</li><li>网易云刷云贝</li><li>定时脚本</li></ul></div><div class="prev-or-next"><div class="post-foot-next"><a href="/%E7%88%B1%E5%A5%BD%E7%AF%87/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91.html" target="_self"><i class="iconfont icon-chevronleft"></i> <span>上一页</span></a></div><div class="post-attach"><span class="post-pubtime"><i class="iconfont icon-updatetime mr-10" title="更新时间"></i> 2022-10-20 10:31:20 </span><span class="post-tags"><i class="iconfont icon-tags mr-10" title="标签"></i> <span class="span--tag mr-8"><a href="/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/" title="树莓派">#树莓派</a></span></span></div><div class="post-foot-prev"><a href="/%E7%88%B1%E5%A5%BD%E7%AF%87/Hexo-Matey.html" target="_self"><span>下一页</span> <i class="iconfont icon-chevronright"></i></a></div></div></div><div id="btn-catalog" class="btn-catalog"><i class="iconfont icon-catalog"></i></div><div class="post-catalog hidden" id="catalog"><div class="title">目录</div><div class="catalog-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A0%91%E8%8E%93%E6%B4%BE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-text">树莓派基础知识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84"><span class="toc-text">架构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83"><span class="toc-text">核心</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C"><span class="toc-text">网络</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E5%AA%92%E4%BD%93"><span class="toc-text">多媒体</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%96%E5%9B%B4%E8%AE%BE%E5%A4%87"><span class="toc-text">外围设备</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A0%91%E8%8E%93%E6%B4%BE%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE"><span class="toc-text">树莓派基本配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#win10%E8%BF%9E%E6%8E%A5%E5%91%BD%E4%BB%A4"><span class="toc-text">win10连接命令</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Raspberry%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85"><span class="toc-text">Raspberry系统安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%91%E8%8E%93%E6%B4%BE%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81"><span class="toc-text">树莓派默认账号密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E6%98%BE%E7%A4%BA%E5%99%A8%E8%BF%9E%E6%8E%A5%E6%A0%91%E8%8E%93%E6%B4%BE"><span class="toc-text">无显示器连接树莓派</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VNC%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5%E6%A0%91%E8%8E%93%E6%B4%BE"><span class="toc-text">VNC远程连接树莓派</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%91%E8%8E%93%E6%B4%BE%E5%9B%BA%E5%AE%9AIP"><span class="toc-text">树莓派固定IP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E6%BA%90"><span class="toc-text">更新源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E6%A1%8C%E9%9D%A2%E7%8E%AF%E5%A2%83"><span class="toc-text">下载桌面环境</span></a></li></ol></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%A3%81%E5%8A%9B%E9%93%BE%E6%8E%A5%E4%B8%8B%E8%BD%BD%E6%9C%BA"><span class="toc-text">磁力链接下载机</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%82%E8%BD%BD%E7%A3%81%E7%9B%98%E5%B7%A5%E5%85%B7"><span class="toc-text">挂载磁盘工具</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E7%94%B5%E8%A7%86%E6%9C%BA%E7%9B%92%E5%AD%90"><span class="toc-text">安装电视机盒子</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85CentOS%E7%B3%BB%E7%BB%9F"><span class="toc-text">安装CentOS系统</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85ubuntu%E7%B3%BB%E7%BB%9F"><span class="toc-text">安装ubuntu系统</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96SD%E5%8D%A1"><span class="toc-text">格式化SD卡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%88%BB%E5%BD%95%E5%B7%A5%E5%85%B7"><span class="toc-text">使用刻录工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AF%86%E7%A0%81"><span class="toc-text">修改树莓派密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E6%BA%90-1"><span class="toc-text">更新源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E6%A1%8C%E9%9D%A2%E7%8E%AF%E5%A2%83-1"><span class="toc-text">下载桌面环境</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8C%82%E8%BD%BD%E7%A3%81%E7%9B%98"><span class="toc-text">挂载磁盘</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85aira2%E4%B8%8B%E8%BD%BD%E6%9C%BA"><span class="toc-text">安装aira2下载机</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98%E4%B8%8B%E8%BD%BD%E6%9C%BA"><span class="toc-text">安装百度网盘下载机</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-text">安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%99%BB%E9%99%86"><span class="toc-text">登陆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE"><span class="toc-text">设置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85emby-server%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-text">安装emby server服务器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85next-cloud%E4%BA%91%E7%9B%98"><span class="toc-text">安装next cloud云盘</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2%E5%92%8C%E8%AE%BE%E7%BD%AEnextcloud"><span class="toc-text">部署和设置nextcloud</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E5%AE%83"><span class="toc-text">其它</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85kodi"><span class="toc-text">安装kodi</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85hexo%E5%8D%9A%E5%AE%A2"><span class="toc-text">安装hexo博客</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85wordpress%E5%8D%9A%E5%AE%A2"><span class="toc-text">安装wordpress博客</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85qbittorrent"><span class="toc-text">安装qbittorrent</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85qBittorrent"><span class="toc-text">安装qBittorrent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8qbittorrent"><span class="toc-text">启动qbittorrent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF"><span class="toc-text">服务开机自启</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="toc-text">方法一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="toc-text">方法二</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85openwrt"><span class="toc-text">安装openwrt</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85dns"><span class="toc-text">安装dns</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Adguard-Home"><span class="toc-text">安装Adguard Home</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85ftp"><span class="toc-text">安装ftp</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85docker"><span class="toc-text">安装docker</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Samba"><span class="toc-text">安装Samba</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%87%86%E5%A4%87"><span class="toc-text">安装准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%8F%8A%E9%85%8D%E7%BD%AE"><span class="toc-text">安装及配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85owv"><span class="toc-text">安装owv</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E9%98%BF%E9%87%8C%E7%BD%91%E7%9B%98"><span class="toc-text">安装阿里网盘</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85emby"><span class="toc-text">安装emby</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Nginx"><span class="toc-text">安装Nginx</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2"><span class="toc-text">自动化部署博客</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CNS%E6%90%AD%E5%BB%BA"><span class="toc-text">CNS搭建</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E5%85%8D%E6%B5%81TinyProxy"><span class="toc-text">搭建免流TinyProxy</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E5%85%8D%E6%B5%81%E9%9D%A2%E6%9D%BF%E6%9C%8D%E5%8A%A1"><span class="toc-text">搭建免流面板服务</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DHCP%E6%90%AD%E5%BB%BA"><span class="toc-text">DHCP搭建</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E8%84%9A%E6%9C%AC%E6%90%AD%E5%BB%BA"><span class="toc-text">自动脚本搭建</span></a></li></div></div><script src="/js/catalog.js"></script><div class="comments-container"></div></div><div class="footer"><div class="social"><ul><li><a title="github" target="_blank" rel="noopener" href="https://github.com/heweiliang88"><i class="iconfont icon-github"></i></a></li><li><a title="email" href=""><i class="iconfont icon-envelope"></i></a></li><li><a title="facebook" href=""><i class="iconfont icon-facebooksquare"></i></a></li><li><a title="twitter" href=""><i class="iconfont icon-twitter"></i></a></li><li><a title="wechat" href=""><i class="iconfont icon-wechat"></i></a></li><li><a title="weibo" href=""><i class="iconfont icon-weibo"></i></a></li></ul></div><div class="footer-more"><a target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">Copyright © 2022 cloud</a></div><div class="footer-more"><a target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">Theme by Oranges | Powered by Hexo</a></div></div></div><div class="tools-bar"><div class="back-to-top tools-bar-item hidden"><a href="javascript: void(0)"><i class="iconfont icon-chevronup"></i></a></div><script src="/js/backtotop.js"></script><div class="search-icon tools-bar-item" id="search-icon"><a href="javascript: void(0)"><i class="iconfont icon-search"></i></a></div><div class="search-overlay hidden"><div class="search-content" tabindex="0"><div class="search-title"><span class="search-icon-input"><a href="javascript: void(0)"><i class="iconfont icon-search"></i> </a></span><input type="text" class="search-input" id="search-input" placeholder="搜索..."> <span class="search-close-icon" id="search-close-icon"><a href="javascript: void(0)"><i class="iconfont icon-close"></i></a></span></div><div class="search-result" id="search-result"></div></div></div><script type="text/javascript">var inputArea=document.querySelector("#search-input"),searchOverlayArea=document.querySelector(".search-overlay");function openOrHideSearchContent(){searchOverlayArea.classList.contains("hidden")?(searchOverlayArea.classList.remove("hidden"),document.body.classList.add("hidden")):(searchOverlayArea.classList.add("hidden"),document.body.classList.remove("hidden"))}function blurSearchContent(e){e.target===searchOverlayArea&&openOrHideSearchContent()}inputArea.onclick=function(){getSearchFile(),this.onclick=null},inputArea.onkeydown=function(){if(13==event.keyCode)return!1},document.querySelector("#search-icon").addEventListener("click",openOrHideSearchContent,!1),document.querySelector("#search-close-icon").addEventListener("click",openOrHideSearchContent,!1),searchOverlayArea.addEventListener("click",blurSearchContent,!1);var searchFunc=function(e,t,n){"use strict";var r=document.getElementById(t),a=document.getElementById(n);a.innerHTML="<ul><span class='local-search-empty'>首次搜索，正在载入索引文件，请稍后……<span></ul>",$.ajax({url:e,dataType:"xml",success:function(e){var t=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get();a.innerHTML="",r.addEventListener("input",function(){var u='<ul class="search-result-list">',h=this.value.trim().toLowerCase().split(/[\s\-]+/);if(a.innerHTML="",!(this.value.trim().length<=0)){if(t.forEach(function(e){var n,r,a=!0,t=(e.title&&""!==e.title.trim()||(e.title="Untitled"),e.title.trim()),c=t.toLowerCase(),s=e.content.trim().replace(/<[^>]+>/g,""),i=s.toLowerCase(),e=e.url,l=-1,o=-1;""!==i?h.forEach(function(e,t){n=c.indexOf(e),l=i.indexOf(e),n<0&&l<0?a=!1:(l<0&&(l=0),0==t&&(o=l))}):a=!1,a&&(u+="<li><a href='"+e+"' class='search-result-title'>"+t+"</a>",0<=o&&(e=o+80,(e=0==(t=(t=o-20)<0?0:t)?100:e)>s.length&&(e=s.length),r=s.substr(t,e),h.forEach(function(e){var t=new RegExp(e,"gi");r=r.replace(t,'<span class="search-keyword">'+e+"</span>")}),u+='<p class="search-result-abstract">'+r+"...</p>"),u+="</li>")}),-1===(u+="</ul>").indexOf("<li>"))return a.innerHTML="<ul><span class='local-search-empty'>没有找到内容，请尝试更换检索词。<span></ul>";a.innerHTML=u}})},error:function(e,t,n){a.innerHTML="",404===e.status?a.innerHTML="<ul><span class='local-search-empty'>未找到search.xml文件，具体请参考：<a href='https://github.com/zchengsite/hexo-theme-oranges#configuration' target='_black'>configuration</a><span></ul>":a.innerHTML="<ul><span class='local-search-empty'>请求失败，尝试重新刷新页面或稍后重试。<span></ul>"}}),$(document).on("click","#search-close-icon",function(){$("#search-input").val(""),$("#search-result").html("")})},getSearchFile=function(){searchFunc("/search.xml","search-input","search-result")}</script><div class="tools-bar-item theme-icon" id="switch-color-scheme"><a href="javascript: void(0)"><i id="theme-icon" class="iconfont icon-moon"></i></a></div><script src="/js/colorscheme.js"></script><div class="share-icon tools-bar-item"><a href="javascript: void(0)" id="share-icon"><i class="iconfont iconshare"></i></a><div class="share-content hidden"><a class="share-item" href="https://twitter.com/intent/tweet?text=' + %E6%A0%91%E8%8E%93%E6%B4%BE%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E7%81%B0 + '&url=' + http%3A%2F%2Fexample.com%2F%25E7%2588%25B1%25E5%25A5%25BD%25E7%25AF%2587%2F%25E6%25A0%2591%25E8%258E%2593%25E6%25B4%25BE.html + '" target="_blank" title="Twitter"><i class="iconfont icon-twitter"></i> </a><a class="share-item" href="https://www.facebook.com/sharer.php?u=http://example.com/%E7%88%B1%E5%A5%BD%E7%AF%87/%E6%A0%91%E8%8E%93%E6%B4%BE.html" target="_blank" title="Facebook"><i class="iconfont icon-facebooksquare"></i></a></div></div><script src="/js/shares.js"></script></div></div></body></html>